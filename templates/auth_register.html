{% extends 'base.html' %}
{% block title %}Register · DentalCare{% endblock %}
{% block content %}
<section class="hero"><div class="hero-bg"></div></section>
<div class="container narrow">
  <form method="post" class="form glass" style="max-width: 480px; margin: 2rem auto; padding: 2.5rem;">
    <div style="text-align: center; margin-bottom: 2rem;">
      <h1 style="margin: 0 0 0.5rem;">Create Account</h1>
      <p class="muted">Join DentalCare and manage your clinic</p>
    </div>

    {% for m in get_flashed_messages(with_categories=true) %}
      <div class="flash {{ m[0] }}">{{ m[1] }}</div>
    {% endfor %}

    {% if request.args.get('create_from_booking') %}
      <input type="hidden" name="create_from_booking" value="{{ request.args.get('create_from_booking') }}">
    {% endif %}

    <label>Full name
      <input name="name" placeholder="John Doe" value="{{ request.args.get('name', '') }}" required>
    </label>
    <label>Email
      <input name="email" type="email" placeholder="your@email.com" required>
    </label>
    <label>Password
      <input name="password" type="password" placeholder="••••••••" required>
    </label>
    <label>Contact
      <input name="contact" placeholder="(555) 000-0000" value="{{ request.args.get('contact', '') }}">
    </label>
    <label>Role
      <select name="role" id="role-select" required>
        <option value="Customer">Customer</option>
        <option value="Staff">Staff</option>
        <option value="Dentist">Dentist</option>
      </select>
    </label>
    <label id="specialty-label">Specialty
      <select name="specialty" id="specialty-select">
        <option value="">Select Specialty</option>
        <option value="General Dentistry">General Dentistry</option>
        <option value="Orthodontics">Orthodontics</option>
        <option value="Periodontics">Periodontics</option>
        <option value="Endodontics">Endodontics</option>
        <option value="Prosthodontics">Prosthodontics</option>
        <option value="Oral Surgery">Oral Surgery</option>
        <option value="Pediatric Dentistry">Pediatric Dentistry</option>
        <option value="Cosmetic Dentistry">Cosmetic Dentistry</option>
        <option value="Implantology">Implantology</option>
        <option value="Other">Other</option>
      </select>
    </label>

    <button class="btn btn-primary" type="submit">Create account</button>

    <p class="muted">Already registered? <a href="/login" style="color: var(--primary); font-weight: 600; text-decoration: none;">Sign in</a></p>
  </form>

  <script>
    (function(){
      const role = document.getElementById('role-select');
      const specLabel = document.getElementById('specialty-label');
      const specSelect = document.getElementById('specialty-select');
      const sync = () => {
        const isDentist = role.value === 'Dentist';
        specLabel.style.display = isDentist ? 'grid' : 'none';
        specSelect.disabled = !isDentist;
        if (!isDentist) specSelect.value = '';
      };
      role.addEventListener('change', sync);
      document.addEventListener('DOMContentLoaded', sync);
      sync();
    })();
  </script>
</div>
{% endblock %}
